{"version":3,"file":"static/js/745.4d6075f7.chunk.js","mappings":"uJACA,MAAyB,0B,SCCV,SAASA,EAAT,GAKX,IAAD,IAJDC,KAAAA,OAIC,MAJM,SAIN,EAHDC,EAGC,EAHDA,SACAC,EAEC,EAFDA,SACAC,EACC,EADDA,aAEA,OACE,mBACEC,UAAWC,EACXC,QAASJ,EACTF,KAAMA,EACNO,SAAUJ,EAJZ,SAMGF,M,mGCdP,EAA4B,wBAA5B,EAA4D,oBAA5D,EAAuF,mBAAvF,EAAkH,oBAAlH,EAAkJ,wBAAlJ,EAA4L,8BAA5L,EAAkO,oBAAlO,EAA4P,kBAA5P,EAAmS,iCAAnS,EAA+V,uCAA/V,EAAwZ,8B,0DCQzY,SAASO,EAAT,GAA0C,IAA1BC,EAAyB,EAAzBA,UAAWC,EAAc,EAAdA,WAClCC,GAASC,EAAAA,EAAAA,IAAU,CACvBC,cAAe,CACbC,KAAM,GACNC,MAAO,GACPC,MAAO,GACPC,YAAa,EACbC,MAAO,IAGTC,SAAU,SAAAC,GACRC,OAIEA,EAAU,mCAAG,+GAEQC,IAAAA,IAAU,UAFlB,iBAEPC,EAFO,EAEPA,MACCC,SACPC,EAAaF,EAAKG,OAJL,yGAAH,qDASVC,EAAiB,WACrB,MAAmDhB,EAAOS,OAAlDN,EAAR,EAAQA,KAAMC,EAAd,EAAcA,MAAOC,EAArB,EAAqBA,MAAOC,EAA5B,EAA4BA,YAAaC,EAAzC,EAAyCA,MAErCU,EAAW,IAAIC,SAQnB,OANAD,EAASE,OAAO,OAAQhB,GACxBc,EAASG,IAAI,QAAShB,GACtBa,EAASG,IAAI,QAASf,GACtBY,EAASG,IAAI,cAAed,GAC5BW,EAASE,OAAO,QAASZ,GAElBU,GAGHH,EAAY,mCAAG,WAAMC,GAAN,iEACnBM,MAAM,gEAAiE,CACrEC,OAAQ,OACRC,KAAMP,IACNQ,QAAS,CAAEC,MAAOV,KAEjBW,MAAK,SAAUC,GACd,OAAOA,EAASC,UAEjBF,MAAK,SAAUd,GAGd,GAFAiB,QAAQC,IAAIlB,GAERA,EAAKC,QAEP,OADAd,GAAW,SAAAgC,GAAK,OAAKA,KACdC,OAGVC,OAAM,SAAUC,OAjBA,2CAAH,sDAsBZC,EAAgB,SAAAC,GAGpB,IAFA,IAAIC,EAAY,CAAC,aAAc,cAAe,aAErCC,EAAI,EAAGA,EAAID,EAAUE,OAAQD,IACpC,GAAIF,EAAK/C,OAASgD,EAAUC,GAC1B,OAAO,EAIX,OAAO,GAGHE,EAAqB,WAIzB,IAHA,IAAIC,EAAQC,SAASC,cAAc,iBAC/BC,EAAUF,SAASC,cAAc,YAE9BC,EAAQC,YACbD,EAAQE,YAAYF,EAAQC,YAG9B,IAAIE,EAAWN,EAAMO,MAErB,GAAwB,IAApBD,EAASR,YAIN,CACL,IAAIU,EAAOP,SAASQ,cAAc,MAClCD,EAAKE,UAAUC,IAAI,aAEnBR,EAAQS,YAAYJ,GACpB,IAAK,IAAIX,EAAI,EAAGA,EAAIS,EAASR,OAAQD,IAAK,CACxC,IAAIgB,EAAWZ,SAASQ,cAAc,MAElCK,EAAOb,SAASQ,cAAc,KAClC,GAAIf,EAAcY,EAAST,IAAK,CAC9BiB,EAAKC,YACHT,EAAST,GAAGnC,KAAO,IAAMsD,EAAeV,EAAST,GAAGoB,MAAQ,IAC9D,IAAIC,EAAQjB,SAASQ,cAAc,OACnCS,EAAMC,IAAMC,OAAOC,IAAIC,gBAAgBhB,EAAST,IAEhDgB,EAASD,YAAYM,GACrBL,EAASD,YAAYE,QAErBA,EAAKC,YACH,aACAT,EAAST,GAAGnC,KACZ,kDACFmD,EAASD,YAAYE,GAGvBN,EAAKI,YAAYC,MAKjBG,EAAiB,SAAAO,GACrB,OAAIA,EAAS,KACJA,EAAS,QACPA,EAAS,MAAQA,EAAS,SAC3BA,EAAS,MAAMC,QAAQ,GAAK,KAC3BD,EAAS,SACVA,EAAS,SAASC,QAAQ,GAAK,UADlC,GASHjC,EAAY,WAChB,IAAMkC,EAAOxB,SAASyB,eAAe,QACrCnE,EAAOgC,UAAU,CACf7B,KAAM,GACNC,MAAO,GACPC,MAAO,GACPC,YAAa,EACbC,MAAO,KAET2D,EAAKE,SAYP,OATAC,EAAAA,EAAAA,YAAU,WAGR,OAFAR,OAAOS,iBAAiB,SAAU9B,GAE3B,WACLqB,OAAOU,oBAAoB,SAAU/B,MAGtC,KAGD,iBAAK/C,UAAWC,EAAa8E,GAAG,WAAhC,WACE,eAAI/E,UAAWC,EAAf,wCAEA,kBAAMD,UAAWC,EAAQc,SAAUR,EAAOyE,aAAcD,GAAG,OAA3D,WACE,kBAAO/E,UAAWC,EAAlB,UACE,kBACE8E,GAAG,OACHE,YAAY,YACZjF,UAAWC,EACXiF,SAAU3E,EAAO4E,aACjBC,MAAO7E,EAAOS,OAAON,KACrBd,KAAK,OACLc,KAAK,OACL2E,QAAQ,yHACRC,MAAM,yIACNC,UAAW,EACXC,UAAU,KACVC,UAAQ,OAIZ,kBAAOzF,UAAWC,EAAlB,UACE,kBACEgF,YAAY,QACZjF,UAAWC,EACXL,KAAK,QACLmF,GAAG,QACHG,SAAU3E,EAAO4E,aACjBC,MAAO7E,EAAOS,OAAOL,MACrBD,KAAK,QAEL6E,UAAW,EACXC,UAAU,MACVC,UAAQ,OAIZ,mBAAOzF,UAAWC,EAAlB,WACE,kBACEgF,YAAY,QACZjF,UAAWC,EACXiF,SAAU3E,EAAO4E,aACjBC,MAAO7E,EAAOS,OAAOJ,MACrBhB,KAAK,MACLc,KAAK,QACLqE,GAAG,QACHM,QAAQ,4BACRC,MAAM,+FACNG,UAAQ,IAXZ,8BAgBA,iDACA,gBAAKzF,UAAWC,EAAhB,gBACGI,QADH,IACGA,OADH,EACGA,EAAWqF,KAAI,SAAAC,GACd,OACE,8BACE,kBACE3F,UAAWC,EACX8E,GAAIY,EAASZ,GACbnF,KAAK,QACLc,KAAK,cACL0E,MAAOO,EAASZ,GAChBG,SAAU3E,EAAO4E,eAElBQ,EAASjF,OATAiF,EAASZ,UAe3B,mBAAOa,QAAQ,eAAe5F,UAAWC,EAAzC,WACE,iBAAMD,UAAWC,EAAjB,qBACA,iBAAMD,UAAU,0BAAhB,mCAEF,kBACEA,UAAWC,EACX8E,GAAG,eACHrE,KAAK,QACLd,KAAK,OACLiG,OAAO,cACPX,SA5Ga,SAAAY,GACnBvF,EAAOS,OAAOF,MAAQgF,EAAMC,cAAcxC,MAAM,IA4G1CkC,UAAQ,KAEV,gBAAKzF,UAAU,aAEf,iBAAKA,UAAWC,EAAhB,WACE,SAACN,EAAA,EAAD,CAAWC,KAAK,SAASG,aAAcQ,EAAOR,aAA9C,SACGQ,EAAOR,aAAe,aAAe,YAF1C,cAlPRmB,IAAAA,SAAAA,QACE","sources":["webpack://test-task-react/./src/components/BtnSignUp/BtnSignUp.module.css?98b1","components/BtnSignUp/BtnSignUp.jsx","webpack://test-task-react/./src/components/Form/Form.module.css?89ba","components/Form/Form.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"button\":\"BtnSignUp_button__yTg46\"};","import s from './BtnSignUp.module.css';\n\nexport default function BtnSignUp({\n  type = 'button',\n  children,\n  showMore,\n  isSubmitting,\n}) {\n  return (\n    <button\n      className={s.button}\n      onClick={showMore}\n      type={type}\n      disabled={isSubmitting}\n    >\n      {children}\n    </button>\n  );\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"Form_container__WXj-7\",\"title\":\"Form_title__5gZHF\",\"form\":\"Form_form__e1yzW\",\"label\":\"Form_label__8nx+5\",\"inputName\":\"Form_inputName__+Pfkf\",\"container_radio\":\"Form_container_radio__2lwgt\",\"radio\":\"Form_radio__JFyFF\",\"btn\":\"Form_btn__0ebGo\",\"input__file_button\":\"Form_input__file_button__b2Hyq\",\"input__file_icon_wrapper\":\"Form_input__file_icon_wrapper__DE07-\",\"visually_hidden\":\"Form_visually_hidden__ttMY1\",\"chose_img\":\"Form_chose_img__v7wEw\",\"preview\":\"Form_preview__IdrOy\"};","import s from './Form.module.css';\nimport { useEffect } from 'react';\nimport BtnSignUp from 'components/BtnSignUp/BtnSignUp';\nimport axios from 'axios';\nimport { useFormik } from 'formik';\n\naxios.defaults.baseURL =\n  'https://frontend-test-assignment-api.abz.agency/api/v1';\n\nexport default function Form({ positions, setAddUser }) {\n  const formik = useFormik({\n    initialValues: {\n      name: '',\n      email: '',\n      phone: '',\n      position_id: 0,\n      photo: '',\n    },\n\n    onSubmit: values => {\n      fetchToken();\n    },\n  });\n\n  const fetchToken = async () => {\n    try {\n      const { data } = await axios.get('/token');\n      if (data.success) {\n        registerUser(data.token);\n      }\n    } catch (error) {}\n  };\n\n  const appendFormData = () => {\n    const { name, email, phone, position_id, photo } = formik.values;\n\n    var formData = new FormData();\n\n    formData.append('name', name);\n    formData.set('email', email);\n    formData.set('phone', phone);\n    formData.set('position_id', position_id);\n    formData.append('photo', photo);\n\n    return formData;\n  };\n\n  const registerUser = async token => {\n    fetch(' https://frontend-test-assignment-api.abz.agency/api/v1/users', {\n      method: 'POST',\n      body: appendFormData(),\n      headers: { Token: token },\n    })\n      .then(function (response) {\n        return response.json();\n      })\n      .then(function (data) {\n        console.log(data);\n\n        if (data.success) {\n          setAddUser(state => !state);\n          return resetForm();\n        }\n      })\n      .catch(function (error) {\n        // обработка сетевых ошибок\n      });\n  };\n\n  const validFileType = file => {\n    var fileTypes = ['image/jpeg', 'image/pjpeg', 'image/png'];\n\n    for (var i = 0; i < fileTypes.length; i++) {\n      if (file.type === fileTypes[i]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  const updateImageDisplay = () => {\n    var input = document.querySelector('#upload-photo');\n    var preview = document.querySelector('.preview');\n\n    while (preview.firstChild) {\n      preview.removeChild(preview.firstChild);\n    }\n\n    var curFiles = input.files;\n\n    if (curFiles.length === 0) {\n      // var para = document.createElement('p');\n      // para.textContent = 'No files currently selected for upload';\n      // preview.appendChild(para);\n    } else {\n      var list = document.createElement('ul');\n      list.classList.add('chose_img');\n\n      preview.appendChild(list);\n      for (var i = 0; i < curFiles.length; i++) {\n        var listItem = document.createElement('li');\n        // eslint-disable-next-line no-redeclare\n        var para = document.createElement('p');\n        if (validFileType(curFiles[i])) {\n          para.textContent =\n            curFiles[i].name + ' ' + returnFileSize(curFiles[i].size) + '.';\n          var image = document.createElement('img');\n          image.src = window.URL.createObjectURL(curFiles[i]);\n\n          listItem.appendChild(image);\n          listItem.appendChild(para);\n        } else {\n          para.textContent =\n            'File name ' +\n            curFiles[i].name +\n            ': Not a valid file type. Update your selection.';\n          listItem.appendChild(para);\n        }\n\n        list.appendChild(listItem);\n      }\n    }\n  };\n\n  const returnFileSize = number => {\n    if (number < 1024) {\n      return number + 'bytes';\n    } else if (number > 1024 && number < 1048576) {\n      return (number / 1024).toFixed(1) + 'KB';\n    } else if (number > 1048576) {\n      return (number / 1048576).toFixed(1) + 'MB';\n    }\n  };\n\n  const uploadAvatar = event => {\n    formik.values.photo = event.currentTarget.files[0];\n  };\n\n  const resetForm = () => {\n    const form = document.getElementById('form');\n    formik.resetForm({\n      name: '',\n      email: '',\n      phone: '',\n      position_id: 0,\n      photo: '',\n    });\n    form.reset();\n  };\n\n  useEffect(() => {\n    window.addEventListener('change', updateImageDisplay);\n\n    return () => {\n      window.removeEventListener('change', updateImageDisplay);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div className={s.container} id=\"register\">\n      <h2 className={s.title}>Working with POST request</h2>\n\n      <form className={s.form} onSubmit={formik.handleSubmit} id=\"form\">\n        <label className={s.label}>\n          <input\n            id=\"name\"\n            placeholder=\"Your name\"\n            className={s.inputName}\n            onChange={formik.handleChange}\n            value={formik.values.name}\n            type=\"text\"\n            name=\"name\"\n            pattern=\"^[a-zA-Zа-яА-Я]+(([' -][a-zA-Zа-яА-Я ])?[a-zA-Zа-яА-Я]*)*$\"\n            title=\"Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan\"\n            minLength={2}\n            maxLength=\"60\"\n            required\n          />\n        </label>\n\n        <label className={s.label}>\n          <input\n            placeholder=\"Email\"\n            className={s.inputName}\n            type=\"email\"\n            id=\"email\"\n            onChange={formik.handleChange}\n            value={formik.values.email}\n            name=\"email\"\n            // pattern=\"\"\n            minLength={2}\n            maxLength=\"100\"\n            required\n          />\n        </label>\n\n        <label className={s.label}>\n          <input\n            placeholder=\"Phone\"\n            className={s.inputName}\n            onChange={formik.handleChange}\n            value={formik.values.phone}\n            type=\"tel\"\n            name=\"phone\"\n            id=\"phone\"\n            pattern=\"^[\\+]{0,1}380([0-9]{9})$\"\n            title=\"Phone number must be digits and can contain spaces, dashes, parentheses and can start with +\"\n            required\n          />\n          +38 (XXX) XXX - XX - XX\n        </label>\n\n        <p>Select your position</p>\n        <div className={s.container_radio}>\n          {positions?.map(position => {\n            return (\n              <label key={position.id}>\n                <input\n                  className={s.radio}\n                  id={position.id}\n                  type=\"radio\"\n                  name=\"position_id\"\n                  value={position.id}\n                  onChange={formik.handleChange}\n                />\n                {position.name}\n              </label>\n            );\n          })}\n        </div>\n\n        <label htmlFor=\"upload-photo\" className={s.input__file_button}>\n          <span className={s.input__file_icon_wrapper}>Upload</span>\n          <span className=\"input__file-button-text\">Upload your photo</span>\n        </label>\n        <input\n          className={s.visually_hidden}\n          id=\"upload-photo\"\n          name=\"photo\"\n          type=\"file\"\n          accept=\".jpg, .jpeg\"\n          onChange={uploadAvatar}\n          required\n        />\n        <div className=\"preview\"></div>\n\n        <div className={s.btn}>\n          <BtnSignUp type=\"submit\" isSubmitting={formik.isSubmitting}>\n            {formik.isSubmitting ? 'Loading...' : 'Sign Up'}\n          </BtnSignUp>\n          \\\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":["BtnSignUp","type","children","showMore","isSubmitting","className","s","onClick","disabled","Form","positions","setAddUser","formik","useFormik","initialValues","name","email","phone","position_id","photo","onSubmit","values","fetchToken","axios","data","success","registerUser","token","appendFormData","formData","FormData","append","set","fetch","method","body","headers","Token","then","response","json","console","log","state","resetForm","catch","error","validFileType","file","fileTypes","i","length","updateImageDisplay","input","document","querySelector","preview","firstChild","removeChild","curFiles","files","list","createElement","classList","add","appendChild","listItem","para","textContent","returnFileSize","size","image","src","window","URL","createObjectURL","number","toFixed","form","getElementById","reset","useEffect","addEventListener","removeEventListener","id","handleSubmit","placeholder","onChange","handleChange","value","pattern","title","minLength","maxLength","required","map","position","htmlFor","accept","event","currentTarget"],"sourceRoot":""}